<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Tic-Tac-Toe Pro PWA</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f172a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<script src="https://cdn.tailwindcss.com"></script>

<script>
tailwind.config = {
  darkMode: 'class',
  theme: {
    extend: {
      colors: {
        primary: '#3b82f6',
        secondary: '#ef4444'
      }
    }
  }
};

(function () {
  const savedTheme = localStorage.getItem('theme_ttt') || 'dark';
  document.documentElement.classList.toggle('dark', savedTheme === 'dark');
})();
</script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');

body { font-family: 'Plus Jakarta Sans', sans-serif; }
.glass {
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}
html.dark .glass {
  background: rgba(30,41,59,0.5);
  border: 1px solid rgba(255,255,255,0.08);
}
html:not(.dark) .glass {
  background: rgba(255,255,255,0.8);
  border: 1px solid rgba(0,0,0,0.1);
}
.board-grid {
  display: grid;
  grid-template-columns: repeat(3,1fr);
  gap: 12px;
}
.cell {
  aspect-ratio: 1/1;
  font-size: 2.5rem;
  font-weight: 900;
}
.mode-btn.active {
  background:#3b82f6;
  color:white;
}
</style>
</head>

<body class="min-h-screen flex flex-col items-center p-4 pt-24">

<button id="themeToggle" class="glass rounded-full p-4 fixed top-6 right-6">ðŸŒ“</button>

<div class="w-full max-w-sm space-y-6">

<h1 class="text-5xl font-black text-center text-primary">TTT PRO</h1>

<div class="flex justify-center glass p-2 rounded-2xl">
  <button id="pvpBtn" class="mode-btn active px-6 py-2 rounded-xl">PvP</button>
  <button id="pvcBtn" class="mode-btn px-6 py-2 rounded-xl">vs CPU</button>
</div>

<div id="status" class="text-center text-sm uppercase tracking-widest text-gray-400">
Waiting for Player X
</div>

<div id="board" class="board-grid">
  <button class="cell glass rounded-3xl" data-index="0"></button>
  <button class="cell glass rounded-3xl" data-index="1"></button>
  <button class="cell glass rounded-3xl" data-index="2"></button>
  <button class="cell glass rounded-3xl" data-index="3"></button>
  <button class="cell glass rounded-3xl" data-index="4"></button>
  <button class="cell glass rounded-3xl" data-index="5"></button>
  <button class="cell glass rounded-3xl" data-index="6"></button>
  <button class="cell glass rounded-3xl" data-index="7"></button>
  <button class="cell glass rounded-3xl" data-index="8"></button>
</div>

<button id="resetBtn" class="w-full glass rounded-3xl py-4">Reset</button>

</div>

<!-- ================= FIXED SCRIPT ================= -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  const board = Array(9).fill(null);
  let currentPlayer = 'X';
  let isGameActive = true;
  let isVsCpu = false;

  const cells = document.querySelectorAll('.cell');
  const statusEl = document.getElementById('status');
  const pvpBtn = document.getElementById('pvpBtn');
  const pvcBtn = document.getElementById('pvcBtn');
  const resetBtn = document.getElementById('resetBtn');

  const wins = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];

  function checkWin() {
    return wins.some(p =>
      board[p[0]] &&
      board[p[0]] === board[p[1]] &&
      board[p[0]] === board[p[2]]
    );
  }

  function reset() {
    board.fill(null);
    cells.forEach(c => c.textContent = '');
    currentPlayer = 'X';
    isGameActive = true;
    statusEl.textContent = "Waiting for Player X";
  }

  cells.forEach(cell => {
    cell.onclick = () => {
      const i = cell.dataset.index;
      if (!isGameActive || board[i]) return;

      board[i] = currentPlayer;
      cell.textContent = currentPlayer;

      if (checkWin()) {
        statusEl.textContent = `Player ${currentPlayer} Wins`;
        isGameActive = false;
        return;
      }

      currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
      statusEl.textContent = `Player ${currentPlayer}'s Turn`;
    };
  });

  pvpBtn.onclick = () => {
    isVsCpu = false;
    pvpBtn.classList.add('active');
    pvcBtn.classList.remove('active');
    reset();
  };

  pvcBtn.onclick = () => {
    isVsCpu = true;
    pvcBtn.classList.add('active');
    pvpBtn.classList.remove('active');
    reset();
  };

  resetBtn.onclick = reset;

});
</script>

</body>
</html>
